
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the Atomist Developer Platform">
      
      
      
        <meta name="author" content="The Atomist Team">
      
      
        <link rel="shortcut icon" href="../../../images/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.7.4">
    
    
      
        <title>Path Expressions - The Atomist Documentation</title>
      
    
    
      <script src="../../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application-769c285a91.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-02c2a4388f.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="green" data-md-color-accent="green">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../../.." title="The Atomist Documentation" class="md-logo md-header-nav__button">
            <img src="../../../images/atomist-logo-horiz-reversed.svg" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  User Guide
                </span>
              
                <span class="md-header-nav__parent">
                  Rug
                </span>
              
            
            Path Expressions
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/atomist/rug" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Rug
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../../images/atomist-logo-horiz-reversed.svg">
      </i>
    
    The Atomist Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/atomist/rug" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Rug
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../capabilities/" title="Capabilities" class="md-nav__link">
      Capabilities
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/prerequisites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/slack/" title="Connect Atomist to Slack" class="md-nav__link">
      Connect Atomist to Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/github/" title="Connect Atomist to GitHub" class="md-nav__link">
      Connect Atomist to GitHub
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      Connect Atomist to CI
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        Connect Atomist to CI
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/ci/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/travis-ci/" title="Travis CI" class="md-nav__link">
      Travis CI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/jenkins/" title="Jenkins" class="md-nav__link">
      Jenkins
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/bot/" title="Atomist Bot" class="md-nav__link">
      Atomist Bot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../getting-started/what-next/" title="What next" class="md-nav__link">
      What next
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/setup-cli/" title="Setup Rug CLI" class="md-nav__link">
      Setup Rug CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/create-rug-project/" title="Create Rug Project" class="md-nav__link">
      Create Rug Project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/setup-typescript/" title="Setup TypeScript" class="md-nav__link">
      Setup TypeScript
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/publish-rug-project/" title="Publish Rug Project" class="md-nav__link">
      Publish Rug Project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/add-bot-command/" title="Add Bot Command" class="md-nav__link">
      Add Bot Command
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked>
    
    <label class="md-nav__link" for="nav-4-2">
      Rug
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Rug
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../event-handlers/" title="Event Handlers" class="md-nav__link">
      Event Handlers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command-handlers/" title="Command Handlers" class="md-nav__link">
      Command Handlers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../editors/" title="Editors" class="md-nav__link">
      Editors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../generators/" title="Generators" class="md-nav__link">
      Generators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rug-functions/" title="Rug Functions" class="md-nav__link">
      Rug Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../secrets/" title="Secrets" class="md-nav__link">
      Secrets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../extensions/" title="Extensions" class="md-nav__link">
      Extensions
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Path Expressions
      </label>
    
    <a href="./" title="Path Expressions" class="md-nav__link md-nav__link--active">
      Path Expressions
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#surgical-selections" title="Surgical selections" class="md-nav__link">
    Surgical selections
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query-the-file-system" title="Query the file system" class="md-nav__link">
    Query the file system
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-the-code" title="Query the code" class="md-nav__link">
    Query the code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trees-versus-graphs" title="Trees Versus Graphs" class="md-nav__link">
    Trees Versus Graphs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-trees" title="Project Trees" class="md-nav__link">
    Project Trees
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cortex-graph" title="Cortex Graph" class="md-nav__link">
    Cortex Graph
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practice-reuse-of-path-expression-components" title="Best Practice: Reuse of Path Expression Components" class="md-nav__link">
    Best Practice: Reuse of Path Expression Components
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../microgrammars/" title="Microgrammars" class="md-nav__link">
      Microgrammars
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../templates/" title="Templates" class="md-nav__link">
      Templates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tests/" title="Tests" class="md-nav__link">
      Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../projects/" title="Projects" class="md-nav__link">
      Projects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../archives/" title="Archives" class="md-nav__link">
      Archives
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lifecycle/" title="Lifecycle" class="md-nav__link">
      Lifecycle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../runtime/" title="Runtime" class="md-nav__link">
      Runtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../conventions/" title="Conventions" class="md-nav__link">
      Conventions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Integrations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Integrations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/slack/" title="Slack" class="md-nav__link">
      Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/github/" title="GitHub.com" class="md-nav__link">
      GitHub.com
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/travis-ci/" title="Travis CI" class="md-nav__link">
      Travis CI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../integrations/jenkins/" title="Jenkins" class="md-nav__link">
      Jenkins
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      Interfaces
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        Interfaces
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/bot/" title="Bot" class="md-nav__link">
      Bot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4-3" type="checkbox" id="nav-4-4-3">
    
    <label class="md-nav__link" for="nav-4-4-3">
      CLI
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-4-3">
        CLI
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/cli/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/cli/install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/cli/basics/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/cli/using-rugs/" title="Using Rugs" class="md-nav__link">
      Using Rugs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/cli/developing-rugs/" title="Developing Rugs" class="md-nav__link">
      Developing Rugs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fingerprints/" title="Fingerprints" class="md-nav__link">
      Fingerprints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seeds/" title="Seeds" class="md-nav__link">
      Seeds
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../spring-agent/" title="Spring Agent" class="md-nav__link">
      Spring Agent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Permissions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Permissions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../permissions/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../permissions/slack/" title="Slack Scopes" class="md-nav__link">
      Slack Scopes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../permissions/github/" title="GitHub Scopes" class="md-nav__link">
      GitHub Scopes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Reference Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Reference Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Rug
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        Rug
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/extensions/" title="Extensions" class="md-nav__link">
      Extensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug/path-expressions/" title="Path Expressions" class="md-nav__link">
      Path Expressions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reference/rug-cli/" title="Rug CLI" class="md-nav__link">
      Rug CLI
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#surgical-selections" title="Surgical selections" class="md-nav__link">
    Surgical selections
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query-the-file-system" title="Query the file system" class="md-nav__link">
    Query the file system
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-the-code" title="Query the code" class="md-nav__link">
    Query the code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trees-versus-graphs" title="Trees Versus Graphs" class="md-nav__link">
    Trees Versus Graphs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-trees" title="Project Trees" class="md-nav__link">
    Project Trees
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cortex-graph" title="Cortex Graph" class="md-nav__link">
    Cortex Graph
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practice-reuse-of-path-expression-components" title="Best Practice: Reuse of Path Expression Components" class="md-nav__link">
    Best Practice: Reuse of Path Expression Components
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Path Expressions</h1>
                
                <p>Rug path expressions, inspired by <a href="https://www.w3.org/TR/xpath/">XPath</a>, provide a means to
navigate entities in Rug with high precision.  From selecting events
with highly-specific criteria to matching only certain <code>catch</code> blocks,
path expressions from a powerful and flexible way to select code and
events to operate on.</p>
<div class="admonition tip">
<p class="admonition-title">Path expressions everywhere</p>
<p>Path expressions are a core concept everywhere in Rug.  Their
detailed semantics differ between project operations and handlers,
but the fact that everything is addressable and navigable from any
starting point is universally applicable.</p>
</div>
<!-- Everything is a tree, path expressions enable precise navigation
of trees of information. -->

<h2 id="surgical-selections">Surgical selections<a class="headerlink" href="#surgical-selections" title="Permanent link">&para;</a></h2>
<p>When running a Rug against a <code>Project</code>, you can locate a file with a
known name with some code like the following line:</p>
<div class="codehilite"><pre><span></span><span class="nx">project</span><span class="p">.</span><span class="nx">findFile</span><span class="p">(</span><span class="s2">&quot;mkdocs.yml&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;&lt;NAME&gt;&quot;</span><span class="p">,</span> <span class="nx">project</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</pre></div>

<p>This approach provides a simple mechanism for finding a file within a
project if you know its path.  But what if you want to select a file
based on something other than its path?  What if you want to select
several files that all satisfy common criteria?  What if you want to
select just a part of a file?  To allow users to select elements with
such flexibility and specificity, Atomist provides a powerful tool
called <em>path expressions</em>.</p>
<h3 id="query-the-file-system">Query the file system<a class="headerlink" href="#query-the-file-system" title="Permanent link">&para;</a></h3>
<p>The above code selecting a file by path can be written as a path
expression.  First, we must import the <code class="codehilite"><span class="nx">PathExpressionEngine</span></code></p>
<div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">PathExpressionEngine</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&quot;@atomist/rug/tree/PathExpression&quot;</span><span class="p">;</span>
</pre></div>

<p>and fetch the <code class="codehilite"><span class="nx">PathExpressionEngine</span></code> from the
<code class="codehilite"><span class="nx">Project</span></code> context.</p>
<div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nx">eng</span>: <span class="kt">PathExpressionEngine</span> <span class="o">=</span> <span class="nx">project</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">pathExpressionEngine</span><span class="p">;</span>
</pre></div>

<p>We then rewrite the <code class="codehilite"><span class="nx">findFile</span><span class="p">()</span></code> function call using the
<code class="codehilite"><span class="nx">PathExpressionEngine</span></code> method <code class="codehilite"><span class="kd">with</span><span class="p">()</span></code>,
supplying the appropriate path expression to select the file based on
name.</p>
<div class="codehilite"><pre><span></span><span class="nx">eng</span><span class="p">.</span><span class="kd">with</span><span class="o">&lt;</span><span class="nx">File</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">project</span><span class="p">,</span> <span class="s2">&quot;/*[@name=&#39;mkdocs.yml&#39;]&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">f</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;&lt;NAME&gt;&quot;</span><span class="p">,</span> <span class="nx">project</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
<span class="p">})</span>
</pre></div>

<p>The final argument of of the <code class="codehilite"><span class="kd">with</span><span class="p">()</span></code> method is a
function which receives as its argument all <code class="codehilite"><span class="nx">File</span></code>s that
satisfy the path expression, one at a time, and can then operate on
each match in turn.  Here we call the <code class="codehilite"><span class="nx">replace</span><span class="p">()</span></code> method
just as we did before.  For this simple case, using path expressions
may is a bit more involved, but it demonstrates the concepts well.</p>
<h3 id="query-the-code">Query the code<a class="headerlink" href="#query-the-code" title="Permanent link">&para;</a></h3>
<p>While querying a project for files using path expressions allows for
greater flexibility than the other means of navigating files in a
project, a more powerful way is to query the content of the target file
directly. This file is a YAML structure, we therefore use a
specific path expression engine that knows how to navigate this kind
of structure.</p>
<p>First the expected import statements:</p>
<div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">yaml</span> <span class="nx">from</span> <span class="s2">&quot;@atomist/rug/ast/yaml/Types&quot;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">YamlPathExpressionEngine</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&quot;@atomist/rug/ast/yaml/YamlPathExpressionEngine&quot;</span><span class="p">;</span>
</pre></div>

<p>Let&rsquo;s amend our previous example:</p>
<div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nx">eng</span>: <span class="kt">PathExpressionEngine</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YamlPathExpressionEngine</span><span class="p">(</span><span class="nx">project</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">pathExpressionEngine</span><span class="p">);</span>

<span class="nx">eng</span><span class="p">.</span><span class="kd">with</span><span class="o">&lt;</span><span class="nx">yaml</span><span class="p">.</span><span class="nx">YamlString</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">project</span><span class="p">,</span> <span class="s2">&quot;/*[@name=&#39;mkdocs.yml&#39;]/YamlFile()/*[@name=&#39;site_name&#39;]&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">field</span><span class="p">.</span><span class="nx">updateText</span><span class="p">(</span><span class="nx">project</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
<span class="p">})</span>
</pre></div>

<p>First we create a specific YAML-aware path expression engine, this
will offer us appropriate methods to work on a YAML structure.  The
path expression we provide begins with the familiar file system query,
identifying a file named <code>mkdocs.yml</code>.  The next step in the path
expression, <code>YamlFile()</code> is something new.  The <code>YamlFile()</code> step
tells Rug to address the file(s) it has found using the preceding
criteria as not just a generic <code class="codehilite"><span class="nx">File</span></code>, but a more
specific <code class="codehilite"><span class="nx">YamlFile</span></code>.  The <code class="codehilite"><span class="nx">YamlFile</span></code> type
has the ability to enter into the YAML syntax tree, allowing you to
query and select individual elements of the YAML document.  Here,
<code>/*[@name='site_name']</code> tells Rug that we want fields named
<code>site_name</code> in the parsed YAML document.  Each such field in the YAML
document is passed to the function defined in the third argument to
<code class="codehilite"><span class="kd">with</span><span class="p">()</span></code>.  This function replaces the original value of
that field using the method <code class="codehilite"><span class="nx">field</span><span class="p">.</span><span class="nx">updateText</span><span class="p">(</span><span class="nx">project</span><span class="p">.</span><span class="nx">name</span><span class="p">())</span></code>, a method defined specifically on
the <code>yaml.YamlString</code> type.</p>
<h2 id="trees-versus-graphs">Trees Versus Graphs<a class="headerlink" href="#trees-versus-graphs" title="Permanent link">&para;</a></h2>
<p>While path expressions are core to Rug, there&rsquo;s an important
difference between path expressions against projects, which you
typically write in editors, and path expressions against the Atomist
Cortex (the overall model for your development team): <em>Project
structure is a tree, while the Cortex structure is a graph.</em></p>
<h3 id="project-trees">Project Trees<a class="headerlink" href="#project-trees" title="Permanent link">&para;</a></h3>
<p>When you write a path expression against your projects, you are
naturally drilling <em>down</em> into its structure. The structure is
naturally hierarchical. There will be no cycles and you&rsquo;ll eventually
end up with terminal nodes, that have no further relationships. There
is only a single path between the root node and any descendant. You
can assume in your code that all data in the tree will be available to
you as you continue to descend.</p>
<p>Consider the following path expression against a project:</p>
<div class="codehilite"><pre><span></span>//JavaFile()//catchClause//catchType[@value=&#39;Exception&#39;]
</pre></div>

<p>It drills into the AST of Java files to find every catch clause that
catches type <code>Exception</code>. Note that we use <code>//</code> to find all
descendants with the given name, so we can ignore the number of
intermediate steps in the Java language grammar. (However,
the <a href="https://github.com/antlr/grammars-v4/blob/master/java8/Java8.g4" title="ANTLR Grammar for Java 8">ANTLR grammar for Java</a> is a useful reference. The
production names we use such as <code>catchClause</code> are directly taken from
it.)</p>
<p>The tree abstraction works seamlessly and intuitively across project
directory structure (which is itself a tree) and the ASTs of
structured files within projects. Catching <code>Exception</code> is usually bad
practice in production code. However, there may be times when we&rsquo;re
quite happy to do it in tests. Assuming our projects follow a
conventional Java project layout, we can easily modify this path
expression to match only production code, by prepending a directory
path:</p>
<div class="codehilite"><pre><span></span>/src/main/java//JavaFile()//catchClause//catchType[@value=&#39;Exception&#39;]
</pre></div>

<p>This will only drill into files in the <code>src/main/java</code> directory.</p>
<h3 id="cortex-graph">Cortex Graph<a class="headerlink" href="#cortex-graph" title="Permanent link">&para;</a></h3>
<p>When writing <em>handlers</em>, we are working with the Atomist Cortex model
of your team&rsquo;s development data. This is a <em>graph</em> rather than a
tree. Some key differences:</p>
<ul>
<li>It&rsquo;s not strictly hierarchical</li>
<li>There may be cycles</li>
<li>The notion of a &ldquo;terminal node&rdquo; is less clear</li>
<li>There can be more than one path between two nodes. (Note that when
    we drill into a project we switch from a graph to a tree. Once in
    tree mode we can rely on tree semantics all the way down.)</li>
</ul>
<p>With the more general graph model, the concept of <em>materialization</em>
becomes important. Unlike when working with project trees, we can no
longer assume that all data will be available if we keep
navigating. (This is impossible as without a guarantee of terminal
nodes, a graph&rsquo;s relationships may never terminate.)</p>
<p>Thus, with the Cortex model, path expressions have two functions:</p>
<ol>
<li>Limit what nodes match, just as in project trees</li>
<li>Specify how deep graph materialization should be be. <em>We can
    assume that any node referenced in the query will be available
    whenever we have a match, meaning that we don&rsquo;t have to check for
    null or undefined in our TypeScript or JavaScript code.</em></li>
<li>Because we aren&rsquo;t working with a strict hierarchy, and because
    there can be multiple paths between nodes, the <code>//</code> <em>self or
    descendants</em> axis tends to be less useful. Similarly, the notion
    of descending via <code>/</code> is less intuitive and relevant.</li>
</ol>
<p>Thus we often choose to build path expressions using <em>query by
example</em>. This is an established technique for searching for data via
examples of data that should match.</p>
<div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">cortex</span> <span class="nx">from</span> <span class="s2">&quot;@atomist/cortex/stub/Types&quot;</span><span class="p">;</span>
<span class="kr">import</span> <span class="o">*</span> <span class="kr">as</span> <span class="nx">query</span> <span class="nx">from</span> <span class="s1">&#39;@atomist/rugs/util/tree/QueryByExample&#39;</span><span class="p">;</span>

<span class="p">...</span>

<span class="kd">@EventHandler</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span>
    <span class="nx">query</span><span class="p">.</span><span class="nx">forRoot</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">cortex</span><span class="p">.</span><span class="nx">Build</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">withStatus</span><span class="p">(</span><span class="s2">&quot;passed&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">withRepo</span><span class="p">(</span>
            <span class="k">new</span> <span class="nx">cortex</span><span class="p">.</span><span class="nx">Repo</span><span class="p">().</span><span class="nx">withOwner</span><span class="p">(</span><span class="s2">&quot;atomist&quot;</span><span class="p">)</span>
        <span class="p">)</span>
<span class="p">)</span>
</pre></div>

<p>We first import the Cortex stubs. These implement Cortex interfaces
such as <code>Build</code> and <code>Repo</code>, and are used for query by example and
testing. Then we can instantiate a graph of example objects by using
no-arg constructors and fluent builder methods such as <code>withStatus</code>.</p>
<p>Then you can use the functions in the <code>QueryByExample</code> module from the
<code>rugs</code> node module. In this case, the <code>forRoot</code> function will
interrogate the object graph to create predicates reflecting the
relationships and simple properties. The generated path expression
will look as follows:</p>
<div class="codehilite"><pre><span></span>/Build()[@status=&#39;passed&#39;]
    [/repo::Repo()[@owner=&#39;atomist&#39;]]
</pre></div>

<p>Thus the example above is equivalent to:</p>
<div class="codehilite"><pre><span></span><span class="kd">@EventHandler</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span>
    <span class="sb">`/Build()[@status=&#39;passed&#39;]</span>
<span class="sb">        [/repo::Repo()[@owner=&#39;atomist&#39;]]`</span><span class="p">)</span>
</pre></div>

<p>Query by example has the advantage of excellent tool support. Your
favorite editor will provide suggestions for potential paths and</p>
<h2 id="best-practice-reuse-of-path-expression-components">Best Practice: Reuse of Path Expression Components<a class="headerlink" href="#best-practice-reuse-of-path-expression-components" title="Permanent link">&para;</a></h2>
<p>Path expressions are inherently composable, whether in editors,
reviewer or handlers.</p>
<p>Whether using a path expression string style or query by example, it&rsquo;s
good practice to reuse predicates for subgraphs. Take our previous
query:</p>
<div class="codehilite"><pre><span></span><span class="nx">query</span><span class="p">.</span><span class="nx">forRoot</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">cortex</span><span class="p">.</span><span class="nx">Build</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">withStatus</span><span class="p">(</span><span class="s2">&quot;passed&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">withRepo</span><span class="p">(</span>
            <span class="k">new</span> <span class="nx">cortex</span><span class="p">.</span><span class="nx">Repo</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">withOwner</span><span class="p">(</span><span class="s2">&quot;atomist&quot;</span><span class="p">)</span>
        <span class="p">);</span>
</pre></div>

<p>This can be rewritten as follows, simply using TypeScript constructs:</p>
<div class="codehilite"><pre><span></span><span class="nx">query</span><span class="p">.</span><span class="nx">forRoot</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">cortex</span><span class="p">.</span><span class="nx">Build</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">withStatus</span><span class="p">(</span><span class="s2">&quot;passed&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">withRepo</span><span class="p">(</span><span class="nx">atomistRepo</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">atomistRepo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">cortex</span><span class="p">.</span><span class="nx">Repo</span><span class="p">().</span><span class="nx">withOwner</span><span class="p">(</span><span class="s2">&quot;atomist&quot;</span><span class="p">);</span>
</pre></div>

<p>Obviously the benefit is greater when path expressions are complex.</p>
<p>We can also use functions, rather than constants, to parameterize
commonly used subgraphs.</p>
<p>Such reuse is a convenient way of capturing commonly needed structures
for materialization as well as narrowing matches, eliminating
duplication and ensuring we have one place to keep them up to date.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../extensions/" title="Extensions" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Extensions
              </span>
            </div>
          </a>
        
        
          <a href="../microgrammars/" title="Microgrammars" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Microgrammars
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2017 Atomist, Inc.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://the-composition.com/" class="md-footer-social__link fa fa-medium"></a>
    
      <a href="https://github.com/atomist" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/atomist" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://join.atomist.com/" class="md-footer-social__link fa fa-slack"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application-c35428f87f.js"></script>
      
      
      <script>app.initialize({url:{base:"../../.."}})</script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-74966852-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>